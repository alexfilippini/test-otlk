<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp 
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictaskpane/1.0" 
  xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0" 
  xsi:type="MailApp">
  
  <!-- ID univoco del componente aggiuntivo. Sostituisci con un nuovo GUID -->
  <Id>111ab7b3-b86e-4e1d-aed4-ef2e2147fe61</Id>
  
  <Version>1.0.0.0</Version>
  <ProviderName>Your Company</ProviderName>
  <DefaultLocale>it-IT</DefaultLocale>
  
  <!-- Nome e descrizione del componente aggiuntivo -->
  <DisplayName DefaultValue="Email Data Exporter" />
  <Description DefaultValue="Invia i dati dell'email tramite HTTP POST a un endpoint API"/>
  
  <!-- URL delle icone (sostituisci con i tuoi URL HTTPS) -->
  <IconUrl DefaultValue="https://alexfilippini.github.io/test-otlk/assets/icon-32.png" />
  <HighResolutionIconUrl DefaultValue="https://alexfilippini.github.io/test-otlk/assets/icon-80.png"/>
  
  <SupportUrl DefaultValue="https://alexfilippini.github.io/test-otlk/support" />
  
  <!-- Domini esterni che l'add-in puÃ² contattare -->
  <AppDomains>
    <AppDomain>https://webhook.site/fa0fcbe2-e92c-4b56-8b13-24db45d74159</AppDomain>
  </AppDomains>
  
  <Hosts>
    <Host Name="Mailbox" />
  </Hosts>
  
  <Requirements>
    <Sets>
      <Set Name="Mailbox" MinVersion="1.1" />
    </Sets>
  </Requirements>
  
  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://alexfilippini.github.io/test-otlk/taskpane.html"/>
        <RequestedHeight>250</RequestedHeight>
      </DesktopSettings>
    </Form>
  </FormSettings>
  
  <Permissions>ReadItem</Permissions>
  
  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read" />
  </Rule>
  
  <DisableEntityHighlighting>false</DisableEntityHighlighting>
  
  <!-- Configurazione versioni avanzate per pulsanti ribbon -->
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
    <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">
      
      <Requirements>
        <bt:Sets DefaultMinVersion="1.3">
          <bt:Set Name="Mailbox" />
        </bt:Sets>
      </Requirements>
      
      <Hosts>
        <Host xsi:type="MailHost">
          
          <!-- Configurazione per Desktop -->
          <DesktopFormFactor>
            
            <!-- File che contiene le funzioni JavaScript -->
            <FunctionFile resid="Commands.Url" />
            
            <!-- Punto di estensione per la lettura messaggi -->
            <ExtensionPoint xsi:type="MessageReadCommandSurface">
              
              <!-- Aggiungi al tab predefinito -->
              <OfficeTab id="TabDefault">
                
                <Group id="msgReadGroup">
                  <Label resid="GroupLabel" />
                  
                  <!-- Pulsante per inviare i dati -->
                  <Control xsi:type="Button" id="msgReadSendData">
                    <Label resid="SendDataButton.Label" />
                    
                    <Supertip>
                      <Title resid="SendDataButton.Label" />
                      <Description resid="SendDataButton.Tooltip" />
                    </Supertip>
                    
                    <Icon>
                      <bt:Image size="16" resid="Icon.16x16" />
                      <bt:Image size="32" resid="Icon.32x32" />
                      <bt:Image size="80" resid="Icon.80x80" />
                    </Icon>
                    
                    <!-- Azione: esegui funzione JavaScript -->
                    <Action xsi:type="ExecuteFunction">
                      <FunctionName>sendEmailData</FunctionName>
                    </Action>
                    
                  </Control>
                  
                </Group>
                
              </OfficeTab>
              
            </ExtensionPoint>
            
          </DesktopFormFactor>
          
        </Host>
      </Hosts>
      
      <!-- Risorse: immagini, URL e stringhe -->
      <Resources>
        
        <bt:Images>
          <bt:Image id="Icon.16x16" DefaultValue="https://alexfilippini.github.io/test-otlk/assets/icon-16.png"/>
          <bt:Image id="Icon.32x32" DefaultValue="https://alexfilippini.github.io/test-otlk/assets/icon-32.png"/>
          <bt:Image id="Icon.80x80" DefaultValue="https://alexfilippini.github.io/test-otlk/assets/icon-80.png"/>
        </bt:Images>
        
        <bt:Urls>
          <bt:Url id="Commands.Url" DefaultValue="https://alexfilippini.github.io/test-otlk/commands.html" />
        </bt:Urls>
        
        <bt:ShortStrings>
          <bt:String id="GroupLabel" DefaultValue="Email Exporter"/>
          <bt:String id="SendDataButton.Label" DefaultValue="Invia Dati"/>
        </bt:ShortStrings>
        
        <bt:LongStrings>
          <bt:String id="SendDataButton.Tooltip" DefaultValue="Invia i dati dell'email al server tramite HTTP POST"/>
        </bt:LongStrings>
        
      </Resources>
      
    </VersionOverrides>
  </VersionOverrides>
  
</OfficeApp>